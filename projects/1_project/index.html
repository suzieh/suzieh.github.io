<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Local Manifold Distance | Suzie L. Hoops</title> <meta name="author" content="Suzie L. Hoops"> <meta name="description" content="(R) Removing the arch/horseshoe effect in dimensionality reduction methods."> <meta name="keywords" content="suzie-hoops, susan-hoops"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/suzie-favicon-android-chrome-192x192.png"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://suzieh.github.io/projects/1_project/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Suzie </span>L. Hoops</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="nav-item "> <a class="nav-link" href="/presentations/">presentations</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Local Manifold Distance</h1> <p class="post-description">(R) Removing the arch/horseshoe effect in dimensionality reduction methods.</p> </header> <article> <p>This work has been published with <em>Bioinformatics</em>. Read the <a href="https://doi.org/10.1093/bioinformatics/btad727" rel="external nofollow noopener" target="_blank">full article here</a>.</p> <hr> <h2 id="lmdist-for-dimensionality-reduction">LMdist for Dimensionality Reduction</h2> <p>Here we give a brief introduction to Local Manifold Distance (LMdist), an algorithm for adjusting pairwise distances in dimensionality reduction in order to remove the “arch effect.”</p> <p> </p> <h4 id="the-problem-archhorseshoe-effect">The problem: Arch/Horseshoe Effect</h4> <p>Let’s start with the problem: <strong>what is the arch/horseshoe effect?</strong></p> <p>When conducting dimensionality reduction on big, multivariate datasets, it is common to see the data points form an arch-like formation. It was debated where this was coming from, but most researchers tended to ignore the effect as some “anomaly.”</p> <p>I found that <strong>the arch and horseshoe appear when a gradient is being sampled</strong>. So, if the data points are collected along some gradient like temperature, age, pH, or even time. If the ends of the scale are very different from one another, then the arch would appear.</p> <p>Consider for example this soil dataset, where each dot represents a soil sample taken at a different pH level. The arch is clearly evident, making <strong>samples at the ends of the pH gradient appear too close together</strong> in the plot. Not representative of the more linear relationship we expect!</p> <p> </p> <div class="row justify-content-sm-center"> <div class="col-6"> <figure> <picture> <img src="/assets/img/hoops_lmdist_2023_before.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Soil PCoA before correction" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> PCoA plot of Soil microbiome samples with varying pH levels. The closer sample points appear to one another, the more similar their microbiome content. The plot clearly demonstrates an arched shape, not quite the linear pH relationship we would expect. </div> <p> </p> <h4 id="the-hypothesisalgorithm-need-adjusted-distances">The hypothesis/algorithm: Need adjusted distances</h4> <p>This got me thinking - what if the reason the arch appears with gradients is because the ends of the gradient don’t have much in common? This would affect the pairwise distance measures we use underlying the visualization.</p> <p>We can <strong>use graph theory and machine learning</strong> to <strong>adjust distances according to local relationships</strong>. This will keep short distances the same while making longer distances more accurate for samples at opposite ends of the gradient.</p> <p> </p> <div class="row justify-content-sm-center"> <div class="col"> <figure> <picture> <img src="/assets/img/hoops_lmdist_2023_algorithm.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Soil PCoA before correction" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> A visual representation of the LMdist algorithm. (A) PCoA plot with an arch/horseshoe shape. (B) Given a radius, (C) we connect any other samples within that radius to the sample. (D) We connect neighbors for all samples until we have a fully connected graph. (E) We can recalculate distances by traversing these paths, thereby extending long ditances. (F) Using these adjusted distances as input for dimensionality reduction, we can resolve the linear gradient! </div> <p> </p> <h4 id="the-solution-lmdist-recovers-gradients">The solution: LMdist recovers gradients</h4> <p>Through verification with a series of simulated datasets, <strong>LMdist-adjusted distances more accuarately represent real distances</strong>, removing the bounded effect of typical dimensionality reduction approaches.</p> <p>Applying the LMdist algorithm, we can <strong>resolve the pH gradient along the x-axis</strong>. This is exciting on its own, but we also find that other variation between the soil samples is now shown in the y-axis direction - meaning we have enabled the <strong>discovery of new findings</strong>!</p> <p> </p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/hoops_lmdist_2023_before.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Soil PCoA before correction" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/hoops_lmdist_2023_after.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Soil PCoA before correction" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> PCoA plots of the soil samples before (left) and after (right) applying the LMdist algorithm. </div> <p>APA citation: <strong>Hoops, Susan L.</strong>, &amp; Knights, Dan (2023). LMdist: Local Manifold distance accurately measures beta diversity in ecological gradients. Bioinformatics, 39(12), btad727.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Suzie L. Hoops. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>